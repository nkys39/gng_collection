# GNG-T (Growing Neural Gas with Triangulation)

## 概要

GNG-T (Growing Neural Gas with Triangulation) は、Kubota & Satomi (2008) により提案された GNG の拡張である。標準GNGにヒューリスティックな三角形分割（四角形探索・交差点探索）を追加し、より適切な三角形メッシュ構造を維持する。

## 元論文

- Kubota, N. & Satomi, M. (2008). "Growing Neural Gas with Triangulation for reconstructing a 3D surface model"
- World Automation Congress (2008)
- 久保田直行, 里見将志 (2008). "自己増殖型ニューラルネットワークと教師無し分類学習"

## 理論的背景

### GCS との関係

GCS (Growing Cell Structures) は Delaunay 三角形分割を維持しながらノードを追加するが、ノードやエッジの削除を行わないため、複数のクラスタへの分割ができない。

### GNG との関係

GNG はノードやエッジの追加・削除を行うが、必ずしも Delaunay 三角形分割を完全には行えない（交差するエッジが発生する可能性がある）。

### GNG-T の位置づけ

GNG-T は、GNG の柔軟性（ノード/エッジの追加・削除）を維持しながら、ヒューリスティックな三角形分割探索により交差エッジを除去し、より適切なメッシュ構造を維持する。

## アルゴリズム

### 初期化

GCS と同様に、2次元単体（3ノードの三角形）から開始する。

### 主要ステップ

1-7: 標準GNGと同じ
- Step 1: 入力データ v を取得
- Step 2: 勝者ノード s1 と第2勝者ノード s2 を選択
- Step 3: 勝者の積算誤差を更新
- Step 4: 勝者と近傍ノードの参照ベクトルを更新
- Step 5: s1-s2 間にエッジを作成/リセット
- Step 6: s1 に接続するエッジの年齢をインクリメント
- Step 7: max_age を超えるエッジを削除（孤立ノードも削除）

8: ノード追加（λ回ごと）
- 最大誤差ノード q を選択
- q の近傍で最大誤差ノード f を選択
- q-f 間に新ノード r を挿入
- q と f に共通して接続するノードとも接続（GCS方式）

9: **三角形分割探索（GNG-T固有）**
- 四角形探索
- 交差点探索

### 四角形探索（Section 2.5.1）

対角線を持たない四角形を探索し、短い方の対角線を追加する。

```
1. 任意の頂点 A を選択
2. A と結合関係のある2つのノード B, C を選択（B-C 間にエッジなし）
3. B と C に共通して結合関係のあるノード D を探索（A-D 間にエッジなし）
4. A-B-D-C が四角形候補
5. 四角形内部に他のノードがないことを確認
6. 対角線 AD と BC の距離を比較し、短い方を追加
```

### 交差点探索（Section 2.5.2）

エッジの交差を検出し、長い方のエッジを削除する。

```
1. すべてのエッジペアについて交差を判定
2. 線分 BD と CE の交差判定:
   γ1 = (xC - xE)(yD - yC) + (yC - yE)(xC - xD)
   γ2 = (xC - xE)(yB - yC) + (yC - yE)(xC - xB)
3. γ1 * γ2 ≤ 0 なら交差
4. 長い方のエッジを削除
```

## パラメータ

| パラメータ | 説明 | 典型値 |
|-----------|------|--------|
| max_nodes | 最大ノード数 | 100 |
| λ (lambda_) | ノード挿入間隔 | 100 |
| ε_b (eps_b) | 勝者の学習率 | 0.08 |
| ε_n (eps_n) | 近傍の学習率 | 0.008 |
| α (alpha) | エラー減衰（挿入時） | 0.5 |
| β (beta) | エラー減衰（毎ステップ） | 0.005 |
| max_age | 最大エッジ年齢 | 100 |

### トラッキング用パラメータ

| パラメータ | 値 |
|-----------|-----|
| max_nodes | 50 |
| λ | 20 |
| ε_b | 0.15 |
| ε_n | 0.01 |
| β | 0.01 |
| max_age | 30 |

## GNG, GCS, GNG-D との比較

| 特性 | GNG | GCS | GNG-T | GNG-D |
|-----|-----|-----|-------|-------|
| ノード追加 | ✓ | ✓ | ✓ | ✓ |
| ノード削除 | ✓ | - | ✓ | - |
| エッジ削除 | ✓ (max_age) | - | ✓ | - |
| 三角形分割 | 近似 | 厳密 | ヒューリスティック | 厳密 |
| 初期化 | 2ノード | 3ノード | 3ノード | 2ノード |
| 計算コスト | 低 | 低 | 中 | 高 |

## シミュレーション結果（論文より）

3つのリング状データ分布での比較（50000回学習）:

| アルゴリズム | 計算時間 [ms] | ノード数 | エッジ数 |
|-------------|--------------|---------|---------|
| NG | 11400 | 135 | 264 |
| GCS | 1200 | 136 | 407 |
| GNG | 3900 | 135 | 261 |
| GNG-T | 5400 | 135 | 284 |

GNG-T は GNG より計算時間が長いが、GCS より短く、適切な三角形分割を行える。

## 利点

1. **クラスタ分離が可能**
   - GCS と異なり、複数のクラスタに分割可能
   - エッジとノードの削除機能を保持

2. **交差エッジの除去**
   - 交差点探索により不正なエッジを削除
   - より適切なメッシュ構造

3. **GCS より高速**
   - Delaunay の完全再計算を行わない
   - ヒューリスティックな探索で効率的

## 欠点

1. **GNG より計算コストが高い**
   - 四角形探索・交差点探索のオーバーヘッド

2. **厳密な Delaunay ではない**
   - ヒューリスティックなため、一部の四角形や交差を見逃す可能性

3. **データの偏りに敏感**
   - ノイズの影響で不正な三角形分割が発生する可能性

## 適用例

- 3次元サーフェスモデルの再構築
- メッシュ生成
- ロボットビジョン
- リアルタイム追跡

## 参考文献

1. Kubota, N. & Satomi, M. (2008). "Growing Neural Gas with Triangulation for reconstructing a 3D surface model"
   World Automation Congress.

2. 久保田直行, 里見将志 (2008). "自己増殖型ニューラルネットワークと教師無し分類学習"
   システム/制御/情報, Vol.52, No.11, pp.421-428.

3. Fritzke, B. (1995). "A Growing Neural Gas Network Learns Topologies"
   Advances in Neural Information Processing Systems 7.

4. Fritzke, B. (1994). "Growing cell structures - a self-organizing network"
   Artificial Neural Networks, Vol.2, No.2.
