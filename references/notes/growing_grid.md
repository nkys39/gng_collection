# Growing Grid (GG)

## 概要

Growing Grid は、Fritzke によって1995年に提案された自己組織化ネットワークである。
SOM のグリッド構造を持ちながら、高エラー領域で行または列を追加して成長する。

## 元論文

- Fritzke, B. (1995). "Growing Grid - a self-organizing network with constant
  neighborhood range and adaptation strength"
  Advances in Neural Information Processing Systems 7 (NIPS 1994)

## アルゴリズム

1. 小さな矩形グリッド（例: 2×2）で初期化
2. 入力信号 ξ に対して:
   - 最近傍ノード（BMU）を見つける
   - BMU のエラーを増加: `error_bmu += ||ξ - w_bmu||²`
   - BMU を入力方向に移動: `w_bmu += ε_b * (ξ - w_bmu)`
   - 近傍ノードも移動（一定の近傍範囲）: `w_n += ε_n * h(d) * (ξ - w_n)`
   - 全ノードのエラーを減衰: `error *= (1 - τ)`
3. λ 回の学習ごとに:
   - 境界ノードの中で最大エラーのノードを見つける
   - そのノードの方向に行または列を追加

## SOM との違い

| 特性 | SOM | Growing Grid |
|-----|-----|--------------|
| グリッドサイズ | 固定 | 成長可能 |
| 近傍範囲 | 時間とともに減衰 | 一定 |
| 学習率 | 時間とともに減衰 | 一定 |
| 収束 | 2フェーズ（組織化→微調整） | 継続的学習 |

## パラメータ

| パラメータ | 説明 | 典型値 |
|-----------|------|--------|
| initial_height | 初期グリッド高さ | 2 |
| initial_width | 初期グリッド幅 | 2 |
| max_nodes | 最大ノード数 | 100 |
| λ (lambda_) | 成長間隔 | 100 |
| ε_b (eps_b) | 勝者の学習率 | 0.1 |
| ε_n (eps_n) | 近傍の学習率 | 0.01 |
| σ (sigma) | 近傍範囲（一定） | 1.5 |
| τ (tau) | エラー減衰率 | 0.005 |

## demogng.de 実装

demogng.de では Growing Grid は以下の特徴:

### 近傍関数
Manhattan 距離を使用（SOM と同様）:
```javascript
var dist = Math.abs(bmuI - nodeI) + Math.abs(bmuJ - nodeJ);
var h = Math.exp(-dist * dist / (2 * sigma * sigma));
```

### 成長戦略
境界ノードのエラーに基づいて成長方向を決定:
```javascript
// 上下左右の境界で最大エラーのノードを探す
// その方向に行/列を追加
```

### エラー計算
二乗距離を使用:
```javascript
bmu.error += mindist;  // 二乗距離
```

## 特徴

### 利点
- **適応的サイズ**: データの複雑さに応じてグリッドが成長
- **継続的学習**: 減衰なしの一定パラメータで継続学習可能
- **トポロジー保持**: グリッド構造で空間関係を保持

### 欠点
- **矩形制約**: 常に矩形グリッドを維持
- **成長方向の制限**: 上下左右にのみ成長
- **非効率な成長**: データ分布と無関係に行/列全体を追加

## GNG との比較

| 特性 | GNG | Growing Grid |
|-----|-----|--------------|
| トポロジー | 自由グラフ | 矩形グリッド |
| 成長単位 | ノード1個 | 行または列全体 |
| エッジ | 動的に生成/削除 | グリッド構造固定 |
| 柔軟性 | 高い | 低い（矩形制約） |
| 可視化 | やや複雑 | グリッドで直感的 |

## 使用場面

- 2Dデータの可視化（グリッド構造が見やすい）
- 画像処理（ピクセルグリッドとの親和性）
- SOM の代替（サイズ自動決定が必要な場合）
- データの大域構造と局所構造の同時学習

## 注意点

Growing Grid は矩形構造を維持するため、リング状や複雑な形状のデータには
GNG の方が適している。また、グリッドが大きくなると全ノードの更新に時間がかかる。
